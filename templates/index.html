{% extends "base.html" %}
{% block content %}
<h2>–°–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ç—å—é —Å AI</h2>
<form id="articleForm">
    <input name="title" placeholder="–¢–µ–º–∞ —Å—Ç–∞—Ç—å–∏" required style="width:100%; padding:10px; margin:5px 0; border:1px solid #ccc; border-radius:4px;"><br>
    <input name="keywords" placeholder="–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)" style="width:100%; padding:10px; margin:5px 0; border:1px solid #ccc; border-radius:4px;"><br>
    <select name="lang" style="width:100%; padding:10px; margin:5px 0; border:1px solid #ccc; border-radius:4px;">
        <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
        <option value="en">üá¨üáß English</option>
    </select><br>
    <button type="submit" style="width:100%; padding:12px; background:#0066cc; color:white; border:none; border-radius:4px; cursor:pointer; font-size:16px;">
        –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—å—é —Å AI
    </button>
</form>
<div id="result" style="margin-top:20px; min-height:30px;"></div>

<script>
document.getElementById('articleForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const form = e.target;
    const submitBtn = form.querySelector('button');
    const originalText = submitBtn.textContent;
    
    submitBtn.textContent = '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è... (10‚Äì30 —Å–µ–∫)';
    submitBtn.disabled = true;
    
    try {
        const res = await fetch('/admin', {
            method: 'POST',
            body: new FormData(form)
        });
        const data = await res.json();
        const resultDiv = document.getElementById('result');
        
        if (data.status === 'success') {
            resultDiv.innerHTML = `
                <div style="padding:12px; background:#d4edda; color:#155724; border:1px solid #c3e6cb; border-radius:4px;">
                    ‚úÖ –°—Ç–∞—Ç—å—è —Å–æ–∑–¥–∞–Ω–∞! <a href="${data.url}" style="color:#0066cc;">–û—Ç–∫—Ä—ã—Ç—å</a>
                </div>
            `;
            form.reset();
        } else {
            resultDiv.innerHTML = `
                <div style="padding:12px; background:#f8d7da; color:#721c24; border:1px solid #f5c6cb; border-radius:4px;">
                    ‚ùå ${data.message || '–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è'}
                </div>
            `;
        }
    } catch (err) {
        document.getElementById('result').innerHTML = `
            <div style="padding:12px; background:#f8d7da; color:#721c24; border:1px solid #f5c6cb; border-radius:4px;">
                ‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
            </div>
        `;
    } finally {
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
    }
});
</script>
{% endblock %}
